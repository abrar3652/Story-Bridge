<!doctype html>
<html lang="en">
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <meta name="theme-color" content="#f97316" />
        <meta name="description" content="StoryBridge - Mobile-first PWA delivering TPRS-based educational stories for children aged 4-10. Offline-capable platform optimized for low-connectivity environments with role-based access for End Users, Creators, Narrators, and Administrators." />
        
        <!-- PWA Manifest -->
        <link rel="manifest" href="%PUBLIC_URL%/manifest.json" />
        
        <!-- PWA Icons -->
        <link rel="icon" type="image/png" sizes="192x192" href="%PUBLIC_URL%/icon-192x192.png" />
        <link rel="icon" type="image/png" sizes="512x512" href="%PUBLIC_URL%/icon-512x512.png" />
        <link rel="apple-touch-icon" href="%PUBLIC_URL%/icon-192x192.png" />
        
        <!-- PWA iOS Support -->
        <meta name="apple-mobile-web-app-capable" content="yes" />
        <meta name="apple-mobile-web-app-status-bar-style" content="default" />
        <meta name="apple-mobile-web-app-title" content="StoryBridge TPRS" />
        
        <!-- Additional PWA metadata -->
        <meta name="mobile-web-app-capable" content="yes" />
        <meta name="application-name" content="StoryBridge" />
        <meta name="msapplication-TileColor" content="#f97316" />
        
        <!-- SEO and Accessibility -->
        <meta name="robots" content="index, follow" />
        <meta name="keywords" content="TPRS methodology, educational stories, children learning, mobile-first PWA, offline education, low-connectivity learning, audio stories, vocabulary building, role-based platform, End User, Creator, Narrator, Administrator" />
        <meta name="author" content="StoryBridge Team" />
        
        <title>StoryBridge - TPRS Educational Stories PWA for Children 4-10</title>
        
        <script>
            // PWA Install prompt handler
            let deferredPrompt;
            
            window.addEventListener('beforeinstallprompt', (e) => {
                console.log('PWA install prompt available');
                e.preventDefault();
                deferredPrompt = e;
                
                // Show custom install button if needed
                const installButton = document.getElementById('pwa-install-button');
                if (installButton) {
                    installButton.style.display = 'block';
                }
            });
            
            // Function to trigger PWA install
            window.installPWA = async () => {
                if (deferredPrompt) {
                    deferredPrompt.prompt();
                    const { outcome } = await deferredPrompt.userChoice;
                    console.log(`PWA install: ${outcome}`);
                    deferredPrompt = null;
                }
            };
            
            // Service Worker registration
            if ('serviceWorker' in navigator) {
                window.addEventListener('load', () => {
                    navigator.serviceWorker.register('/sw.js')
                        .then((registration) => {
                            console.log('SW registered: ', registration);
                        })
                        .catch((registrationError) => {
                            console.log('SW registration failed: ', registrationError);
                        });
                });
            }
        </script>
    </head>
    <body>
        <noscript>You need to enable JavaScript to run this app.</noscript>
        <div id="root"></div>
        
        <!-- PWA Install Button (hidden by default) -->
        <button id="pwa-install-button" style="display: none; position: fixed; bottom: 80px; right: 20px; z-index: 1000; padding: 10px 15px; background: #f97316; color: white; border: none; border-radius: 8px; font-size: 14px; cursor: pointer;" onclick="installPWA()">
            ðŸ“± Install App
        </button>
        
        <a
            id="emergent-badge"
            target="_blank"
            href="https://app.emergent.sh/?utm_source=emergent-badge"
            style="
                display: flex !important;
                align-items: center !important;
                position: fixed !important;
                bottom: 20px;
                right: 20px;
                text-decoration: none;
                padding: 6px 10px;
                font-family: -apple-system, BlinkMacSystemFont,
                    'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell,
                    'Open Sans', 'Helvetica Neue',
                    sans-serif !important;
                font-size: 12px !important;
                z-index: 9999 !important;
                box-shadow: 0 2px 8px rgba(0, 0, 0, 0.15) !important;
                border-radius: 8px !important;
                background-color: #ffffff !important;
                border: 1px solid rgba(255, 255, 255, 0.25) !important;
            "
        >
            <div style="display: flex; flex-direction: row; align-items: center">
                <img
                    style="width: 20px; height: 20px; margin-right: 8px"
                    src="https://avatars.githubusercontent.com/in/1201222?s=120&u=2686cf91179bbafbc7a71bfbc43004cf9ae1acea&v=4"
                />
                <p
                    style="
                        color: #000000;
                        font-family: -apple-system, BlinkMacSystemFont,
                            'Segoe UI', Roboto, Oxygen, Ubuntu,
                            Cantarell, 'Open Sans',
                            'Helvetica Neue', sans-serif !important;
                        font-size: 12px !important;
                        align-items: center;
                        margin-bottom: 0;
                    "
                >
                    Made with Emergent
                </p>
            </div>
        </a>
    </body>
</html>
